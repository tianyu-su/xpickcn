<!DOCTYPE html>
<html lang="zh">

<head>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?849c85d07ce7227b4b0fd5c5e36257b3";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <meta name="author" content="tianyu"/>
    <title>xPick.cn - 口袋导航</title>
    <meta name="keywords"
          content="导航，网址导航,个性化导航，创意导航,创意网站导航,实用工具导航，设计师网址大全,设计师网址导航,产品经理网址导航,交互设计师网址导航,xpick.cn">
    <meta name="description" content="xPick - 收集国内外优秀、有趣、实用的网站，也可以自己定制化，拥有属于自己的专属导航页面。xpick.cn">
    <link rel="shortcut icon" href="../static/images/favicon.png">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Arimo:400,700,400italic">
    <link rel="stylesheet"
          href="../static/css/fonts/linecons/css/linecons.css">
    <link rel="stylesheet"
          href="../static/css/fonts/fontawesome/css/font-awesome.min.css">
    <link rel="stylesheet" href="../static/css/bootstrap.css">
    <link rel="stylesheet" href="../static/css/xenon-core.css">
    <link rel="stylesheet"
          href="../static/css/xenon-components.css">
    <link rel="stylesheet" href="../static/css/xenon-skins.css">
    <link rel="stylesheet" href="../static/css/nav.css">
    <script src="../static/js/jquery-1.11.1.min.js"></script>

    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- / FB Open Graph -->
    <meta property="og:type" content="article">
    <meta property="og:url" content="http://xpick.cn/">
    <meta property="og:title" content="xPick - 收集国内外优秀、有趣、实用的网站，也可以自己定制化，拥有属于自己的专属导航页面。xpick.cn">
    <meta property="og:description"
          content="导航，网址导航,个性化导航，创意导航,创意网站导航,实用工具导航，设计师网址大全,设计师网址导航,产品经理网址导航,交互设计师网址导航,xpick.cn">
    <meta property="og:site_name"
          content="xPick - 收集国内外优秀、实用、有趣的网站、个性化导肮，UI设计资源网站、灵感创意网站、素材资源网站，定时更新分享优质产品设计书签。xpick.cn">
    <!-- / Twitter Cards -->
    <meta name="twitter:card" content="summary_large_image">
    <meta name="twitter:title" content="xPick - 收集国内外优秀、实用、有趣的网站、个性化导肮，UI设计资源网站、灵感创意网站、素材资源网站，定时更新分享优质产品设计书签。xpick.cn">
    <meta name="twitter:description"
          content="导航，网址导航,个性化导航，创意导航,创意网站导航,实用工具导航，设计师网址大全,设计师网址导航,产品经理网址导航,交互设计师网址导航,xpick.cn">

    <style>
        [v-cloak] {
            display: none;
        }
    </style>
</head>

<body class="page-body boxed-container">
<nav class="navbar horizontal-menu navbar-fixed-top">
    <div class="navbar-inner">
        <div class="navbar-brand">
            <a href="/" class="logo">
                <img src="../static/images/logo@black.png"
                     width="100%" alt="" class="hidden-xs">
                <img src="../static/images/logo@2x.png" width="100%"
                     alt="" class="visible-xs">
            </a>
        </div>
</nav>
<div class="page-container">
    <!-- add class "sidebar-collapsed" to close sidebar by default, "chat-visible" to make chat appear always -->
    <div class="main-content" id="app" style="">
        <div class="row">
            <div class="col-md-12">
                <div class="panel panel-default">
                    <!-- 关于网站 -->
                    <h4 class="text-gray" v-cloak>你好, {{ nickname }}，感谢使用口袋导航，请输入你的个性化域名！</h4>
                    <div class="panel-body">
                        <div class="row">
                            <div class="col-sm-12">
                                <div class="form-inline">
                                    <label for="name" class="control-label">个性化域名：</label>

                                    <input type="text" class="form-control" id="name" v-model="sdomain"
                                           placeholder="请输入域名">
                                    <input type="button" class="btn btn-blue" @click="applyDomain" value="申请"/>
                                    <p v-if="sdomain && !own_domain" v-cloak> 待注册导航网址： {{ sdomain }}.xpick.cn</p>

                                </div>
                            </div>
                        </div>
                        <div class="row">

                            <div class="col-md-8">
                                <div class="row">
                                    <div class="col-sm-12" v-cloak="" v-if="communicate">
                                        <br/>
                                        <blockquote>
                                            <p>
                                                {{ communicate }}
                                                <a :href="own_domain"><span class="label label-info"
                                                                            data-toggle="tooltip"
                                                                            data-placement="left"
                                                                            title=""
                                                                            data-original-title="你的专属导航">{{ own_domain }}</span></a>
                                            </p>
                                        </blockquote>
                                    </div>
                                </div>
                                <br>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <!-- Main Footer -->
        <footer class="main-footer sticky footer-type-1 fixed">
            <div class="footer-inner">
                <!-- Add your copyright text here -->
                <div class="footer-text">
                    © 2019-2020
                    <a href="about.html"><strong>xPick</strong></a>
                    design by <a
                        href="https://github.com/tianyu-su" target="_blank"><strong>tianyu</strong></a>.&nbsp
                    Theme by <a href="https://webstack.cc/" target="_blank">WebStack</a>;&nbsp;

                    <a href="http://beian.miit.gov.cn" id="beian" target="_blank">蒙ICP备20003275号</a>
                    <!--  - Purchase for only <strong>23$</strong> -->
                </div>
                <!-- Go to Top Link, just add rel="go-top" to any link to add this functionality -->
                <div class="go-up">
                    <a href="#" rel="go-top">
                        <i class="fa-angle-up"></i>
                    </a>
                </div>
            </div>
        </footer>
    </div>
</div>
<!-- Bottom Scripts -->
<script src="js/bootstrap.min.js"></script>
<script src="js/TweenMax.min.js"></script>
<script src="js/resizeable.js"></script>
<script src="js/joinable.js"></script>
<script src="js/xenon-api.js"></script>
<script src="js/xenon-toggles.js"></script>
<!-- JavaScripts initializations and stuff -->
<script src="js/xenon-custom.js"></script>
<textarea tabindex="-1"
          style="position: absolute; top: -999px; left: 0px; right: auto; bottom: auto; border: 0px; padding: 0px; box-sizing: content-box; word-wrap: break-word; overflow: hidden; transition: none; height: 0px !important; min-height: 0px !important; font-family: Arimo, &quot;Helvetica Neue&quot;, Helvetica, Arial, sans-serif; font-size: 13px; font-weight: 400; font-style: normal; letter-spacing: 0px; text-transform: none; word-spacing: 0px; text-indent: 0px; line-height: 18.5714px; width: 53px;"
          class="autosizejs" id="autosizejs"></textarea>
</body>
<script>
    function getCookie(name) {
        var r = document.cookie.match("\\b" + name + "=([^;]*)\\b");
        return r ? r[1] : undefined;
    }

    function getUrlParam(name) {
        let reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)"); //构造一个含有目标参数的正则表达式对象
        let r = window.location.search.substr(1).match(reg);  //匹配目标参数
        if (r != null) return decodeURI(r[2]);
        return null; //返回参数值
    }

    var vmm = new Vue({
        el: '#app',
        data: {
            nickname: undefined,
            sdomain: undefined,
            communicate: undefined,
            own_domain: undefined
        },
        mounted: function () {
            this.nickname = getUrlParam('nickname')
        },
        methods: {
            applyDomain: function () {
                $.ajax({
                    url: "/bindpage/",
                    dataType: "json",
                    headers: {
                        "X-CSRFToken": getCookie("csrftoken"),
                    },
                    data: {'open_id': getUrlParam('open_id'), 'web_domain': vmm.sdomain},
                    type: "POST",
                    success: function (req, status) {
                        //请求成功时处理
                        if (!req['code']) {
                            vmm.own_domain = window.location.protocol + "//" + req['msg']
                            vmm.communicate = "恭喜你已经注册成功自己的导航网站."
                        } else {
                            // alert('hhh')
                            vmm.communicate = req['msg']
                        }
                    },
                    beforeSend: function () {
                        vmm.communicate = '服务器正在帮你注册个性化域名...'
                    },
                    error: function () {
                        vmm.communicate = '服务器开小差了，请重试！'
                    }
                });
            },
            showData: function () {

                $.get("/api/mine/", function (data, status) {
                    vmm.user_data = data;
                });
            },
        },
    })
</script>
</html>
